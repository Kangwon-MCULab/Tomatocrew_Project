"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const stripJsonComments = require("strip-json-comments");
function indexToLine(content, index) {
    const front = content.substring(0, index);
    var line = 1;
    var lastidx = 0;
    for (;;) {
        const idx = front.indexOf('\n', lastidx);
        if (idx === -1)
            break;
        line++;
        lastidx = idx + 1;
    }
    return {
        line,
        column: index - lastidx
    };
}
exports.indexToLine = indexToLine;
function parseJson(text) {
    try {
        return JSON.parse(stripJsonComments(text));
    }
    catch (err) {
        const regexp = /^(.+) JSON at position ([0-9]+)$/;
        if (regexp.test(err.message)) {
            const index = +RegExp.$2;
            const { line, column } = indexToLine(text, index);
            err.line = line;
            err.column = column;
            err.message = `${RegExp.$1} JSON at line ${line}, column ${column}`;
        }
        throw err;
    }
}
exports.parseJson = parseJson;
//# sourceMappingURL=index.js.map